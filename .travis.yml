sudo: required
dist: xenial
before_cache:
- find $HOME/.sbt -name "*.lock" | xargs rm
- find $HOME/.ivy2 -name "ivydata-*.properties" | xargs rm
cache:
  directories:
  - "$HOME/.ivy2/cache"
  - "$HOME/.sbt"
language: scala
scala:
- 2.12.9
jdk:
- openjdk8
stages:
- test
- formatting
- name: release
  if: tag =~ ^v
- name: snapshot
  if: "(NOT tag IS present) AND (type = push)"
jobs:
  include:
  - stage: test
    script: sbt test
  - stage: formatting
    script: sbt scalafmtCheck
  - stage: release
    script: openssl aes-256-cbc -K $encrypted_98cf3af00429_key -iv $encrypted_98cf3af00429_iv
      -in ci/secring.asc.enc -out ci/secring.asc -d && gpg --import ci/secring.asc
      && sbt -jvm-opts .travis.jvmopts publishSigned sonatypeBundleRelease
  - stage: snapshot
    script: sbt publish
env:
  global:
  - secure: C7f7IVhSNksel6gb90fxWIc922gQtx1+dQqIOCChwTYmJqcT5OxKt104EjvM/ZgyoI4A95gqCdX2qD30NijHIEF55tLSPhaU5aA/knrTg76j+dGt4ZJZTH8JlxwzWM/sz7sV6CiSs7McHbxRu46xu1kF4TM8wW2QqpKoZC6Mh3z7JFC6EIznYZfKjBChgukzgpwn3SZ2SvFNod/QoixV8Ovq81saXqAUmfDGBoAKGmtptRhML9Lh4T0kofnQIJzr6vTlJRSq8o3GBOAUGAjgQoQ9P32Nc9L6qyGCuzYWXovYjIMWz6ISwvpFuGRV9a7+dVco40bJka0LuUto4L3KzTlMIZF7N9dEIJbxJYtmVX0suANX0pFyaLhQD3d1q2A8kMvK2zYxJJVTnhYYyNBqbzirig1gXcNdzonFVqtohVEvOAblMgZa547YRMx2OXS+TpgTQdYI62NOjJQHds8S0pxwu9Lvxs+CHwja7V21FCQt35QFXPB/Lg6lJ9BasHFNaRaSWNyLThMyw/iwpTrWwdnmt6TCTIm6G9mHwRIgeAOLPqdknvE7wewGv2OkleZqbgdkHvkckvwgnQ+tohfxkEaJL2EO1jdaOZoNggz/MvFCL1UEOgKzbdv5iYsfqzwlAZnEOjk6rBfy1aHo3GcQer2bsmsviUmSwB3NFG+++OI=
  - secure: qXZUdgGvpCvNylNKeNBq3dEfKJ2j6/ifHK5IG7H3kDh9NAAqFbwG3ghiTEbMxWV4S6SzGhwbf9XarqQwD5wGJVN+dLGj6w1BzNYOR2Dc84Y6TZtWMqxosMDB9g7/fww9A9syo9oKEruG5XO6jyQxvjEw6Hs7TXC2yDNWpaXLsFOyjltAd+0ik8aNCItQBga0CBX4I9eyBdyC5WGGVe3DqOyHG5Z4TQYJEvHuc4430ZKCh0brZLB/sYqmxqUob9jRHun/i3yjvtpJj3Mh8r0ey4lODllncH1OOQy2aWoCtk9I3V8UbVYLf/9wkpFQQnWrGc7F8vrCc0/C4qvHVIk1B0iDw5j4/KmOyispREbCWV/p+WEOSG2Qr3+IrHcIHXvUCimpLLqF1zCpg+U4v2mO/j8QMGYbs7iZirSCQk5UlENWNGtp64N5mCo9PnIAEwl+QSbkoJYBm8q01MfPPjE30Anc3TOXbSLa+arSffXzVn91yBqIjElftlX3iXFnHDsRjiBz6QwnAxoNNGgNso3aVajkPp0CCVqyyIbpqthdcPhSML8QMiz1YuOCoxpQm3qQ17HjK7Gryd5RAMeZh1gbwk36JEqbqrILfFhIJCaH9geAB/A0T0u66cn6wjqdm/aCBZv0X1BrHmla4pjjgTMbBol0f53lg4/NgFrHKWzQKIE=
